## define path ----
path_pain <- "~/data/paintypes/pain_type/"
path_cov <- "~/data/covariates/"
path_outcome <- "~/data/outcomes/"
path_function <- "~/data/codebank/Model/"
path_output <- "~/data/output/results_F1/cox/"
## paintypes_int0 ----
pain <- read.csv(paste0(path_pain,"pain_filtered_Final.csv"))
pain$Group <- as.factor(pain$Group)
## covariates ----
cov <- read.csv(paste0(path_cov,"cov_noPA_medic.csv"))
## covariates +pain ----
pain_cov<- merge(pain,cov,by="eid")
## disease_survival_data ==> disease_survival_date ----
Anxiety_survival_data <- read.csv(paste0(path_outcome,"Anxiety.csv"))
names(Anxiety_survival_data) <- c("eid","status","days")
Bipolar_survival_data <- read.csv(paste0(path_outcome,"Bipolar.csv"))
names(Bipolar_survival_data) <- c("eid","status","days")
Dementia_survival_data <- read.csv(paste0(path_outcome,"Dementia.csv"))
names(Dementia_survival_data) <- c("eid","status","days")
Dystonia_survival_data <- read.csv(paste0(path_outcome,"Dystonia.csv"))
names(Dystonia_survival_data) <- c("eid","status","days")
MDD_survival_data <- read.csv(paste0(path_outcome,"MDD.csv"))
names(MDD_survival_data) <- c("eid","status","days")
PD_survival_data <- read.csv(paste0(path_outcome,"PD.csv"))
names(PD_survival_data) <- c("eid","status","days")
Sleep_survival_data <- read.csv(paste0(path_outcome,"Sleep.csv"))
names(Sleep_survival_data) <- c("eid","status","days")
Stroke_survival_data <- read.csv(paste0(path_outcome,"Stroke.csv"))
names(Stroke_survival_data) <- c("eid","status","days")
## merge pain, covariates ----
pain_Anxiety_survival_data <- merge(pain_cov,Anxiety_survival_data,by = "eid")
pain_Bipolar_survival_data <- merge(pain_cov,Bipolar_survival_data,by = "eid")
pain_Dementia_survival_data <- merge(pain_cov,Dementia_survival_data,by = "eid")
pain_Dystonia_survival_data <- merge(pain_cov,Dystonia_survival_data,by = "eid")
pain_MDD_survival_data <- merge(pain_cov,MDD_survival_data,by = "eid")
pain_PD_survival_data <- merge(pain_cov,PD_survival_data,by = "eid")
pain_Sleep_survival_data <- merge(pain_cov,Sleep_survival_data,by = "eid")
pain_Stroke_survival_data <- merge(pain_cov,Stroke_survival_data,by = "eid")
## quality control ----
pain_Anxiety_survival_data <- subset(pain_Anxiety_survival_data,pain_Anxiety_survival_data$days > 0)
pain_Bipolar_survival_data <- subset(pain_Bipolar_survival_data,pain_Bipolar_survival_data$days > 0)
pain_Dementia_survival_data <- subset(pain_Dementia_survival_data,pain_Dementia_survival_data$days > 0)
pain_Dystonia_survival_data <- subset(pain_Dystonia_survival_data,pain_Dystonia_survival_data$days > 0)
pain_MDD_survival_data <- subset(pain_MDD_survival_data,pain_MDD_survival_data$days > 0)
pain_PD_survival_data <- subset(pain_PD_survival_data,pain_PD_survival_data$days > 0)
pain_Sleep_survival_data <- subset(pain_Sleep_survival_data,pain_Sleep_survival_data$days > 0)
pain_Stroke_survival_data <- subset(pain_Stroke_survival_data,pain_Stroke_survival_data$days > 0)
## cox model_pain group----
library(survival)
library(ggplot2)
library(ggpubr)
source(paste0(path_function,"cox2022.R"))
survival_Group_one <- NULL
survival_Group_df <- NULL
for (i in c("Anxiety","Bipolar","Dementia","Dystonia",
            "MDD","PD","Sleep","Stroke")){
  survival_name <- paste0("pain_",i,"_survival_data")
  survival_data <- get(survival_name)
  survival_Group_one <- cox2022(survival_data["APvsHC"],survival_data["status"],survival_data["days"],survival_data["eid"],survival_data)
  survival_Group_df <- rbind.data.frame(survival_Group_df,survival_Group_one)
}
write.csv(survival_Group_df,file = paste0(path_output,"Survival_APvsHC_cox.csv"),row.names = F)

source(paste0(path_function,"cox2022.R"))
survival_Group_one <- NULL
survival_Group_df <- NULL
for (i in c("Anxiety","Bipolar","Dementia","Dystonia",
            "MDD","PD","Sleep","Stroke")){
  survival_name <- paste0("pain_",i,"_survival_data")
  survival_data <- get(survival_name)
  survival_Group_one <- cox2022(survival_data["WLPvsHC"],survival_data["status"],survival_data["days"],survival_data["eid"],survival_data)
  survival_Group_df <- rbind.data.frame(survival_Group_df,survival_Group_one)
}

write.csv(survival_Group_df,file = paste0(path_output,"Survival_WLPvsHC_cox.csv"),row.names = F)

source(paste0(path_function,"cox2022.R"))
survival_Group_one <- NULL
survival_Group_df <- NULL
for (i in c("Anxiety","Bipolar","Dementia","Dystonia",
            "MDD","PD","Sleep","Stroke")){
  survival_name <- paste0("pain_",i,"_survival_data")
  survival_data <- get(survival_name)
  survival_Group_one <- cox2022(survival_data["WSPvsHC"],survival_data["status"],survival_data["days"],survival_data["eid"],survival_data)
  survival_Group_df <- rbind.data.frame(survival_Group_df,survival_Group_one)
}

write.csv(survival_Group_df,file = paste0(path_output,"Survival_WSPvsHC_cox.csv"),row.names = F)

source(paste0(path_function,"cox2022.R"))
survival_Group_one <- NULL
survival_Group_df <- NULL
for (i in c("Anxiety","Bipolar","Dementia","Dystonia",
            "MDD","PD","Sleep","Stroke")){
  survival_name <- paste0("pain_",i,"_survival_data")
  survival_data <- get(survival_name)
  survival_Group_one <- cox2022(survival_data["headache_3m"],survival_data["status"],survival_data["days"],survival_data["eid"],survival_data)
  survival_Group_df <- rbind.data.frame(survival_Group_df,survival_Group_one)
}

write.csv(survival_Group_df,file = paste0(path_output,"Survival_headache_3m_cox.csv"),row.names = F)

survival_Group_one <- NULL
survival_Group_df <- NULL
for (i in c("Anxiety","Bipolar","Dementia","Dystonia",
            "MDD","PD","Sleep","Stroke")){
  survival_name <- paste0("pain_",i,"_survival_data")
  survival_data <- get(survival_name)
  survival_Group_one <- cox2022(survival_data["face_pain_3m"],survival_data["status"],survival_data["days"],survival_data["eid"],survival_data)
  survival_Group_df <- rbind.data.frame(survival_Group_df,survival_Group_one)
}

write.csv(survival_Group_df,file = paste0(path_output,"Survival_face_pain_3m_cox.csv"),row.names = F)


survival_Group_one <- NULL
survival_Group_df <- NULL
for (i in c("Anxiety","Bipolar","Dementia","Dystonia",
            "MDD","PD","Sleep","Stroke")){
  survival_name <- paste0("pain_",i,"_survival_data")
  survival_data <- get(survival_name)
  survival_Group_one <- cox2022(survival_data["neck_shoulder_pain_3m"],survival_data["status"],survival_data["days"],survival_data["eid"],survival_data)
  survival_Group_df <- rbind.data.frame(survival_Group_df,survival_Group_one)
}

write.csv(survival_Group_df,file = paste0(path_output,"Survival_neck_shoulder_pain_3m_cox.csv"),row.names = F)


survival_Group_one <- NULL
survival_Group_df <- NULL
for (i in c("Anxiety","Bipolar","Dementia","Dystonia",
            "MDD","PD","Sleep","Stroke")){
  survival_name <- paste0("pain_",i,"_survival_data")
  survival_data <- get(survival_name)
  survival_Group_one <- cox2022(survival_data["back_pain_3m"],survival_data["status"],survival_data["days"],survival_data["eid"],survival_data)
  survival_Group_df <- rbind.data.frame(survival_Group_df,survival_Group_one)
}

write.csv(survival_Group_df,file = paste0(path_output,"Survival_back_pain_3m_cox.csv"),row.names = F)


survival_Group_one <- NULL
survival_Group_df <- NULL
for (i in c("Anxiety","Bipolar","Dementia","Dystonia",
            "MDD","PD","Sleep","Stroke")){
  survival_name <- paste0("pain_",i,"_survival_data")
  survival_data <- get(survival_name)
  survival_Group_one <- cox2022(survival_data["stomach_abdominal_pain_3m"],survival_data["status"],survival_data["days"],survival_data["eid"],survival_data)
  survival_Group_df <- rbind.data.frame(survival_Group_df,survival_Group_one)
}

write.csv(survival_Group_df,file = paste0(path_output,"Survival_stomach_abdominal_pain_3m_cox.csv"),row.names = F)


survival_Group_one <- NULL
survival_Group_df <- NULL
for (i in c("Anxiety","Bipolar","Dementia","Dystonia",
            "MDD","PD","Sleep","Stroke")){
  survival_name <- paste0("pain_",i,"_survival_data")
  survival_data <- get(survival_name)
  survival_Group_one <- cox2022(survival_data["hip_pain_3m"],survival_data["status"],survival_data["days"],survival_data["eid"],survival_data)
  survival_Group_df <- rbind.data.frame(survival_Group_df,survival_Group_one)
}

write.csv(survival_Group_df,file = paste0(path_output,"Survival_hip_pain_3m_cox.csv"),row.names = F)

survival_Group_one <- NULL
survival_Group_df <- NULL
for (i in c("Anxiety","Bipolar","Dementia","Dystonia",
            "MDD","PD","Sleep","Stroke")){
  survival_name <- paste0("pain_",i,"_survival_data")
  survival_data <- get(survival_name)
  survival_Group_one <- cox2022(survival_data["knee_pain_3m"],survival_data["status"],survival_data["days"],survival_data["eid"],survival_data)
  survival_Group_df <- rbind.data.frame(survival_Group_df,survival_Group_one)
}

write.csv(survival_Group_df,file = paste0(path_output,"Survival_knee_pain_3m_cox.csv"),row.names = F)
